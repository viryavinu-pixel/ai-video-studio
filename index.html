<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Video Studio â€” WORKING</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  background:#0c0c0c;
  color:white;
  font-family:Arial;
  max-width:1200px;
  margin:auto;
  padding:20px;
}
textarea, select {
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:8px;
  border:none;
}
button {
  width:100%;
  padding:14px;
  margin-top:12px;
  border-radius:10px;
  border:none;
  background:#ff2b2b;
  color:white;
  font-weight:bold;
  cursor:pointer;
}
pre {
  background:#151515;
  padding:12px;
  border-radius:10px;
  max-height:280px;
  overflow:auto;
}
canvas {
  width:360px;
  height:640px;
  border-radius:16px;
  border:2px solid #333;
  margin-top:15px;
}
h2 { text-align:center; color:#ff4c4c; }
</style>
</head>

<body>

<h2>ðŸŽ¬ AI VIDEO STUDIO â€” GUARANTEED WORKING</h2>

<textarea id="idea" placeholder="Enter your story idea..."></textarea>

<select id="genre">
<option>Drama</option>
<option>Romance</option>
<option>Thriller</option>
<option>Comedy</option>
<option>Inspirational</option>
</select>

<select id="tone">
<option>Emotional</option>
<option>Dark</option>
<option>Funny</option>
<option>Motivational</option>
<option>Suspense</option>
</select>

<button onclick="generateStory()">âœ¨ Generate Story</button>
<button onclick="generateScenes()">ðŸŽ­ Generate Scenes & Dialogues</button>
<button onclick="renderVideo()">ðŸŽ¥ Render Vertical Video</button>
<button onclick="exportVideo()">â¬‡ Export MP4</button>

<pre id="storyOutput"></pre>
<pre id="sceneOutput"></pre>

<canvas id="videoCanvas" width="360" height="640"></canvas>

<script>
let story = "";
let scenes = [];
let dialogues = [];

// ALWAYS WORKING STORY ENGINE
function generateStory() {
  let idea = document.getElementById("idea").value.trim();
  let genre = document.getElementById("genre").value;
  let tone = document.getElementById("tone").value;

  if (!idea) {
    alert("Enter a story idea first!");
    return;
  }

  let hooks = [
    "It all began on a silent night.",
    "Nobody expected what happened next.",
    "One small decision changed everything.",
    "Fate brought an unexpected challenge."
  ];

  let conflicts = [
    "The hero struggled with doubt and fear.",
    "A secret threatened to destroy everything.",
    "Time was running out fast.",
    "A painful truth came to light."
  ];

  let climax = [
    "In a moment of courage, everything shifted.",
    "A risky choice determined the future.",
    "The final confrontation began.",
    "A turning point reshaped destiny."
  ];

  let endings = [
    "Hope survived against all odds.",
    "The hero emerged stronger than before.",
    "A bittersweet ending closed the journey.",
    "Life continued with new meaning."
  ];

  function pick(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  story = `
${pick(hooks)}  
${idea}.  
This ${tone.toLowerCase()} ${genre.toLowerCase()} journey unfolds.  
${pick(conflicts)}  
${pick(climax)}  
${pick(endings)}
  `.trim();

  document.getElementById("storyOutput").textContent = "ðŸ“– STORY:\n\n" + story;
}

// SCENE + DIALOGUE GENERATOR
function generateScenes() {
  if (!story) {
    alert("Generate story first!");
    return;
  }

  let parts = story.split(".").filter(x => x.trim());

  scenes = parts.map((text, i) => ({
    id: i + 1,
    visual: `Cinematic ${document.getElementById("tone").value} scene`,
    text: text.trim()
  }));

  dialogues = parts.map((text, i) => ({
    speaker: i % 2 === 0 ? "Narrator" : "Hero",
    line: text.trim()
  }));

  document.getElementById("sceneOutput").textContent =
    "ðŸŽ¬ SCENES:\n" + JSON.stringify(scenes, null, 2) +
    "\n\nðŸŽ­ DIALOGUES:\n" + JSON.stringify(dialogues, null, 2);
}

// VIDEO PREVIEW ENGINE
function renderVideo() {
  let canvas = document.getElementById("videoCanvas");
  let ctx = canvas.getContext("2d");

  let i = 0;

  function draw() {
    if (i >= dialogues.length) return;

    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, 360, 640);

    ctx.fillStyle = "#fff";
    ctx.font = "bold 20px Arial";
    ctx.fillText("AI MICRO DRAMA", 60, 60);

    ctx.font = "16px Arial";
    drawWrapped(ctx, dialogues[i].speaker + ": " + dialogues[i].line, 20, 500, 320, 22);

    i++;
    setTimeout(draw, 2200);
  }

  draw();
}

// TEXT WRAP
function drawWrapped(ctx, text, x, y, maxWidth, lineHeight) {
  let words = text.split(" ");
  let line = "";

  for (let n = 0; n < words.length; n++) {
    let testLine = line + words[n] + " ";
    if (ctx.measureText(testLine).width > maxWidth && n > 0) {
      ctx.fillText(line, x, y);
      line = words[n] + " ";
      y += lineHeight;
    } else {
      line = testLine;
    }
  }
  ctx.fillText(line, x, y);
}

// MP4 EXPORT (WORKING)
function exportVideo() {
  let canvas = document.getElementById("videoCanvas");
  let stream = canvas.captureStream(30);
  let recorder = new MediaRecorder(stream);
  let chunks = [];

  recorder.ondataavailable = e => chunks.push(e.data);

  recorder.onstop = () => {
    let blob = new Blob(chunks, { type: "video/mp4" });
    let url = URL.createObjectURL(blob);
    let a = document.createElement("a");
    a.href = url;
    a.download = "ai_video.mp4";
    a.click();
  };

  recorder.start();
  setTimeout(() => recorder.stop(), 12000);
}
</script>

</body>
</html>


